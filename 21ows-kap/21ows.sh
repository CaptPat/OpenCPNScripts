#! /bin/sh
# nohal - 2010-10-30
# 21st Operational Weather Squadron.
# http://ows.public.sembach.af.mil

# To run this you need: wget, libbsb, ImageMagic, tar, zip and bzip2
# Configure a bit
OUTPUTDIR="../docs/21ows"
WORKINGDIR="/var/www/virtualhosts/opencpn.xtr.cz/USAF-kap"

# And now do the work
cd $WORKINGDIR

ToKap(){
convert $1.gif -resize 1000x764\< $1.gif
convert $1.gif -font courier -fill red  -gravity SouthEast -pointsize 10 -annotate +3+18 'OpenCPN' $2.gif
convert $2.gif -colors 127 $2.tif
tif2bsb -c 127 $3.hd $2.tif $2.kap
}

Dnld(){
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-0.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-1.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-2.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-3.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-4.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-5.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-6.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-7.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_ANALYSIS_SURFACE_00_SURFACE_SURFACE.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_12.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_18.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_24.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_30.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_36.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_48.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_72.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_96.gif
wget http://131.54.120.150/gifimages/21OWS_EUROPE_FITL_PROG-STANDARD_120.gif
}

ToKaps(){
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-0 21OWS_EU_AN_SAT-0 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-1 21OWS_EU_AN_SAT-1 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-2 21OWS_EU_AN_SAT-2 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-3 21OWS_EU_AN_SAT-3 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-4 21OWS_EU_AN_SAT-4 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-5 21OWS_EU_AN_SAT-5 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-6 21OWS_EU_AN_SAT-6 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_METSAT_00_SFC_METSAT-ANALYSIS-7 21OWS_EU_AN_SAT-7 northatlantic
ToKap 21OWS_EUROPE_ANALYSIS_SURFACE_00_SURFACE_SURFACE 21OWS_EU_AN_SFC northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_12 21OWS_EU_PROG-STD_12 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_18 21OWS_EU_PROG-STD_18 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_24 21OWS_EU_PROG-STD_24 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_30 21OWS_EU_PROG-STD_30 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_36 21OWS_EU_PROG-STD_36 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_48 21OWS_EU_PROG-STD_48 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_72 21OWS_EU_PROG-STD_72 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_96 21OWS_EU_PROG-STD_96 northatlantic
ToKap 21OWS_EUROPE_FITL_PROG-STANDARD_120 21OWS_EU_PROG-STD_120 northatlantic
#Publish
mkdir -p $OUTPUTDIR
cp -f *.kap $OUTPUTDIR
tar c *.kap|bzip2 > all.tar.bz2
zip all.zip *.kap
mv all.tar.bz2 $OUTPUTDIR
mv all.zip $OUTPUTDIR
bzip2 *.kap
mv -f *.kap.bz2 $OUTPUTDIR
}

#Generate KAPs
Dnld
convert 21OWS_EUROPE_ANALYSIS_SURFACE_00_SURFACE_SURFACE.gif -resize 1000x764\< 21OWS_EUROPE_ANALYSIS_SURFACE_00_SURFACE_SURFACE.gif
ToKaps

#Clean up directory
rm *.gif*
rm  *.tif*
rm *~
